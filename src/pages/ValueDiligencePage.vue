<template>
  <div class="value-diligence-page">
    <!-- Hero -->
    <section class="section-luxury text-center">
      <div class="glass-hero-enhanced animate-fade-in">
        <h1 class="heading-luxury mb-6">
          VALUE <span class="text-gradient-gold">DILIGENCE</span>
        </h1>
        <p class="subheading-luxury max-w-3xl mx-auto">
          Strumenti di compliance, verifica reputazionale e due diligence per aziende e istituzioni
        </p>
      </div>
    </section>

    <!-- Intro -->
    <section class="section-luxury">
      <div class="glass-card-enhanced">
        <h2 class="heading-luxury-medium mb-4">Cos'è <span class="text-gradient-gold">Value Diligence</span></h2>
        <p class="body-text-luxury text-sm md:text-base leading-relaxed">
          La sezione Value Diligence offre strumenti di compliance, verifica reputazionale e due diligence a realtà che operano in ambiti regolati o ad alto rischio reputazionale.
        </p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8 mt-6 md:mt-8">
          <div class="p-5 md:p-6 bg-black/20 border border-white/10">
            <h3 class="text-base md:text-lg font-semibold text-luxury-gold mb-3 md:mb-4">Per chi è pensato</h3>
            <ul class="space-y-2 text-sm md:text-base text-luxury-text-secondary">
              <li>Grandi aziende, banche, assicurazioni, SGR</li>
              <li>Studi legali internazionali e pubbliche amministrazioni</li>
              <li>Organizzazioni con elevati requisiti di compliance</li>
            </ul>
          </div>

          <div class="p-5 md:p-6 bg-black/20 border border-white/10">
            <h3 class="text-base md:text-lg font-semibold text-luxury-gold mb-3 md:mb-4">Cosa puoi fare</h3>
            <ul class="space-y-2 text-sm md:text-base text-luxury-text-secondary">
              <li>Accedere in modalità flat e illimitata a report professionali</li>
              <li>Analizzare imprese, persone, asset e gruppi societari</li>
              <li>Affidarti a un team dedicato con alta competenza</li>
              <li>Supportare M&A, onboarding istituzionali, valutazioni rischio AML</li>
              <li>Controllare posizioni apicali e profili reputazionali</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Servizi Disponibili -->
    <section class="section-luxury">
      <div class="text-center mb-12">
        <h2 class="heading-luxury-medium">I <span class="text-gradient-gold">Servizi</span> Disponibili</h2>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-12">
        <div class="glass-card-enhanced">
          <h3 class="text-xl md:text-2xl font-display font-semibold mb-4 text-luxury-gold">Identità &amp; Compliance</h3>
          <p class="body-text-luxury">Controllo su identità, codici fiscali, PEP, CPL, blacklist, liste internazionali.</p>
        </div>
        <div class="glass-card-enhanced">
          <h3 class="text-xl md:text-2xl font-display font-semibold mb-4 text-luxury-gold">Struttura Societaria</h3>
          <p class="body-text-luxury">Analisi partecipazioni dirette e indirette, beneficiari effettivi, quote e cariche.</p>
        </div>
        <div class="glass-card-enhanced">
          <h3 class="text-xl md:text-2xl font-display font-semibold mb-4 text-luxury-gold">Asset &amp; Immobiliare</h3>
          <p class="body-text-luxury">Verifica immobili, veicoli, asset riconducibili a persone fisiche o giuridiche.</p>
        </div>
        <div class="glass-card-enhanced">
          <h3 class="text-xl md:text-2xl font-display font-semibold mb-4 text-luxury-gold">Analisi Reputazionale</h3>
          <p class="body-text-luxury">Monitoraggio eventi negativi, media, procedimenti, protesti, fonti giornalistiche.</p>
        </div>
        <div class="glass-card-enhanced">
          <h3 class="text-xl md:text-2xl font-display font-semibold mb-4 text-luxury-gold">Bilanci &amp; Rating</h3>
          <p class="body-text-luxury">Accesso a bilanci ufficiali, rating creditizi, indici di solvibilità, fatturato e utili.</p>
        </div>
        <div class="glass-card-enhanced">
          <h3 class="text-xl md:text-2xl font-display font-semibold mb-4 text-luxury-gold">Gruppi Collegati</h3>
          <p class="body-text-luxury">Rilevamento automatico di società collegate, soci comuni, partecipazioni incrociate.</p>
        </div>
        <div class="glass-card-enhanced">
          <h3 class="text-xl md:text-2xl font-display font-semibold mb-4 text-luxury-gold">Controllo PA</h3>
          <p class="body-text-luxury">Verifica soggetti pubblici, split payment, classificazioni istituzionali e codici IPA.</p>
        </div>
        <div class="glass-card-enhanced">
          <h3 class="text-xl md:text-2xl font-display font-semibold mb-4 text-luxury-gold">Documenti Certificati</h3>
          <p class="body-text-luxury">Atti ufficiali, visure camerali, certificati anagrafici e immobiliari su richiesta.</p>
        </div>
      </div>
    </section>

    <!-- Perché scegliere -->
    <section class="section-luxury">
      <div class="text-center mb-8">
        <h2 class="heading-luxury-medium">Perché scegliere <span class="text-gradient-gold">Value Diligence</span></h2>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
        <!-- Modello di Attivazione -->
        <div class="glass-card-enhanced">
          <h3 class="text-lg md:text-xl font-display font-semibold mb-3 md:mb-4 text-luxury-gold">Modello di attivazione</h3>
          <ul class="space-y-2 text-sm md:text-base text-luxury-text-secondary">
            <li>Accesso illimitato con formula flat annuale</li>
            <li>Nessuna ricarica a crediti, zero vincoli</li>
          </ul>
        </div>

        <!-- Operatività e Supporto -->
        <div class="glass-card-enhanced">
          <h3 class="text-lg md:text-xl font-display font-semibold mb-3 md:mb-4 text-luxury-gold">Operatività e supporto</h3>
          <ul class="space-y-2 text-sm md:text-base text-luxury-text-secondary">
            <li>Attivazione entro 1 ora dalla richiesta</li>
            <li>Team dedicato con account manager</li>
            <li>Supporto 7/7 dalle 9:00 alle 19:00</li>
          </ul>
        </div>

        <!-- Affidabilità & Compliance -->
        <div class="glass-card-enhanced">
          <h3 class="text-lg md:text-xl font-display font-semibold mb-3 md:mb-4 text-luxury-gold">Affidabilità &amp; compliance</h3>
          <ul class="space-y-2 text-sm md:text-base text-luxury-text-secondary">
            <li>Massima continuità operativa e rispetto normativo</li>
            <li>Scelto da BNP, Euroansa, PWC, Venezia, Aruba, Dentons, UniPi, Sparkasse</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- CTA Form -->
    <section id="top" class="section-luxury text-center">
      <div class="max-w-4xl mx-auto">
        <h2 class="heading-luxury-medium mb-6">Richiedi informazioni o una <span class="text-gradient-gold">demo</span></h2>
        <div class="glass-card-enhanced">
          <form @submit.prevent="submitForm">
            <div class="text-end mb-2 text-gray-700">
              <p class="text-sm">I campi con * sono obbligatori</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8 mb-6 md:mb-8">
              <div>
                <label for="firstName" class="block text-luxury-gold font-semibold mb-2 md:mb-3 tracking-wide text-sm md:text-base">Nome *</label>
                <input id="firstName" v-model="form.firstName" type="text" required class="input-luxury" placeholder="Il tuo nome" :disabled="isSubmitting" />
              </div>
              <div>
                <label for="lastName" class="block text-luxury-gold font-semibold mb-2 md:mb-3 tracking-wide text-sm md:text-base">Cognome *</label>
                <input id="lastName" v-model="form.lastName" type="text" required class="input-luxury" placeholder="Il tuo cognome" :disabled="isSubmitting" />
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8 mb-6 md:mb-8">
              <div>
                <label for="email" class="block text-luxury-gold font-semibold mb-2 md:mb-3 tracking-wide text-sm md:text-base">Email Aziendale *</label>
                <input id="email" v-model="form.email" type="email" required class="input-luxury" placeholder="email@azienda.com" :disabled="isSubmitting" />
              </div>
              <div>
                <label for="phone" class="block text-luxury-gold font-semibold mb-2 md:mb-3 tracking-wide text-sm md:text-base">Numero Cellulare *</label>
                <input id="phone" v-model="form.phone" type="tel" required class="input-luxury" placeholder="+39 123 456 7890" :disabled="isSubmitting" />
              </div>
            </div>

            <div class="mb-6 md:mb-8">
              <label for="company" class="block text-luxury-gold font-semibold mb-2 md:mb-3 tracking-wide text-sm md:text-base">Azienda *</label>
              <input id="company" v-model="form.company" type="text" required class="input-luxury" placeholder="Nome azienda" :disabled="isSubmitting" />
            </div>

            <div class="mb-6 md:mb-8">
              <label for="message" class="block text-luxury-gold font-semibold mb-2 md:mb-3 tracking-wide text-sm md:text-base">Descrivi le tue esigenze</label>
              <textarea id="message" v-model="form.message" rows="4" class="textarea-luxury" placeholder="Descrivi cosa ti serve su imprese, persone, asset... (opzionale)" :disabled="isSubmitting"></textarea>
            </div>

            <div class="mb-8 md:mb-10">
              <label class="flex items-start space-x-3 md:space-x-4">
                <input v-model="form.privacy" type="checkbox" required class="mt-1 text-luxury-gold focus:ring-luxury-gold" :disabled="isSubmitting" />
                <span class="body-text-luxury text-sm md:text-base">
                  Accetto la <router-link to="/privacy-policy" class="text-luxury-gold hover:text-luxury-gold-light underline transition-colors duration-300">Privacy Policy</router-link> e autorizzo il trattamento dei miei dati. *
                </span>
              </label>
            </div>

            <div class="text-center">
              <button type="submit" :disabled="isSubmitting" class="btn-artistic text-luxury-gold text-base md:text-lg px-8 md:px-12 py-4 md:py-6 disabled:opacity-50 disabled:cursor-not-allowed w-full sm:w-auto">
                <span v-if="isSubmitting">Invio in corso...</span>
                <span v-else>➤ Compila il form per Value Diligence</span>
              </button>
            </div>

            <div v-if="submitMessage" class="mt-6 md:mt-8 p-4 md:p-6 rounded-none" :class="submitSuccess ? 'bg-green-900/20 border border-green-500/30 text-green-400' : 'bg-red-900/20 border border-red-500/30 text-red-400'">
              {{ submitMessage }}
            </div>
          </form>
        </div>
      </div>
    </section>
  </div>

</template>

<script>
import { ref } from 'vue'

export default {
  name: 'ValueDiligencePage',
  setup() {
    const form = ref({
      firstName: '',
      lastName: '',
      email: '',
      phone: '',
      company: '',
      message: '',
      privacy: false
    })

    const isSubmitting = ref(false)
    const submitMessage = ref('')
    const submitSuccess = ref(false)

    const validate = () => {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
      if (!emailRegex.test(form.value.email)) {
        return 'Inserisci un indirizzo email valido.'
      }
      const phoneRegex = /^(\+39|39)?[ ]?[0-9]{3}[ ]?[0-9]{3}[ ]?[0-9]{4}$/
      if (!phoneRegex.test(form.value.phone.replace(/\s/g, ''))) {
        return 'Inserisci un numero di cellulare valido (formato: +39 123 456 7890).'
      }
      if (form.value.message && form.value.message.trim() && form.value.message.length < 10) {
        return 'Il messaggio deve contenere almeno 10 caratteri.'
      }
      return null
    }

    const submitForm = async () => {
      isSubmitting.value = true
      submitMessage.value = ''
      try {
        const err = validate()
        if (err) throw new Error(err)

        const to = import.meta.env.VITE_VD_CONTACT_EMAIL || 'info@valuediligence.it'
        const subject = `Richiesta Value Diligence - ${form.value.company}`
        const message = `
Nome: ${form.value.firstName} ${form.value.lastName}
Email: ${form.value.email}
Telefono: ${form.value.phone}
Azienda: ${form.value.company}
Messaggio: ${form.value.message || 'Nessun messaggio aggiuntivo'}
Data: ${new Date().toLocaleString('it-IT')}
User Agent: ${navigator.userAgent}
        `.trim()

        const response = await fetch('/mail.php', {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
          body: new URLSearchParams({ to, subject, message })
        })

        if (!response.ok) throw new Error(`Errore HTTP: ${response.status}`)
        const result = await response.json()
        if (!result.success) throw new Error(result.error || 'Errore durante l\'invio')

        submitSuccess.value = true
        submitMessage.value = 'Richiesta inviata con successo! Riceverai risposta entro 1 ora.'
        form.value = { firstName: '', lastName: '', email: '', phone: '', company: '', message: '', privacy: false }
      } catch (e) {
        submitSuccess.value = false
        submitMessage.value = e.message || 'Si è verificato un errore. Riprova più tardi.'
      } finally {
        isSubmitting.value = false
      }
    }

    return { form, isSubmitting, submitMessage, submitSuccess, submitForm }
  }
}
</script>

<style scoped>
</style>
